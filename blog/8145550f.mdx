---
authors:
- PuQing
date: 2023-07-23 11:26
keywords:
- 微积分
- 多元函数
tags:
- 微积分
- 多元函数
---
# 多元函数的极值 最大值与最小值

## 多元函数的极值 - 必要条件

设函数

$$
u = f(x_1,x_2,\cdots,x_n)
$$
并且定义于区域 $\mathcal{D}$ 中，并且 $(x_1^0,x_2^0,\cdots,x_n^0)$ 是区域上的内点。

:::tip
若点 $(x_1^0,x_2^0,\cdots,x_n^0)$ 存在邻域

$$
\left(x_{1}^{0}-\delta, x_{1}^{0}+\delta ; x_{2}^{0}-\delta, x_{2}^{0}+\delta ; \cdots ; x_{n}^{0}-\delta, x_{n}^{0}+\delta\right)
$$
使得对于其中一切点都能成立不等式

$$
f\left(x_{1}, x_{2}, \cdots, x_{n}\right) \underset{(\geqslant)}{\leqslant} f\left(x_{1}^{0}, x_{2}^{0}, \cdots, x_{n}^{0}\right),
$$
就说函数 $f(x_1,x_2,\cdots,x_n)$ 在点 $(x_1^0,x_2^0,\cdots,x_n^0)$ 处有极大值 (极小值)。

:::
如果这个领域可以加强为把等号去掉，即在去除点 $(x_1^0,x_2^0,\cdots,x_n^0)$ 本身以外的邻域中的每一点都能成立严格不等式

$$
f\left(x_{1}, x_{2}, \cdots, x_{n}\right) \underset{(>)}{<} f\left(x_{1}^{0}, x_{2}^{0}, \cdots, x_{n}^{0}\right),
$$
就说，函数在点 $(x_1^0,x_2^0,\cdots,x_n^0)$ 处有**真正的**极大值 (极小值)，否则，极大值 (极小值) 就是**广义的**。

假定我们的函数在某一点 $(x_1^0,x_2^0,\cdots,x_n^0)$ 处有极值。若在这一点存在着 (**有限**) 偏导数

$$
f_{x_{1}}^{\prime}\left(x_{1}^{0}, x_{2}^{0}, \cdots, x_{n}^{0}\right), \cdots, f_{x_{n}}^{\prime}\left(x_{1}^{0}, x_{2}^{0}, \cdots, x_{n}^{0}\right)
$$
则一切这些偏导数必都等于零，于是，<Highlight>一阶偏导数等于零就是极值存在的必要条件</Highlight>。

:::quote 为什么这里强调了是有限偏导数？

:::
证明过程在此不表。

## 充分条件 (二元函数情景)

就像在一元函数中那样，在静止点并不能保证极值存在，就拿函数 $z=xy$ 来看，

```tikz
\usepackage{pgfplots}
\pgfplotsset{compat=1.16}

\begin{document}

\begin{tikzpicture}
\begin{axis}[colormap/viridis]
\addplot3[
	surf,
	samples=30,
	domain=-5:5
]
{x*y};
\end{axis}
\end{tikzpicture}

\end{document}
```

就有 $z'_x=y,z'_y=x$，静止点为原点 $(0,0)$。但是可以看到在 $(0,0)$ 其实函数的鞍点，并不是极值。

该处的推导过程不表，直接说结论。

设函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 的某邻域内连续且有一阶及二阶连续偏导数，又 $f_{x}\left(x_{0}, y_{0}\right)=0, f_{y}\left(x_{0}, y_{0}\right)=0$，令

$$
f_{x x}\left(x_{0}, y_{0}\right)=A, f_{x y}\left(x_{0}, y_{0}\right)=B, f_{y y}\left(x_{0}, y_{0}\right)=C,
$$
则 $f(x,y)$ 在 $(x_0,y_0)$ 处是否取得极值的条件如下：

:::tip

1. $AC-B^2> 0$ 时具有极值，且当 $A<0$ 时有极大值，当 $A> 0$ 时有极小值；
2. $AC-B^2<0$ 时没有极值；
3. $AC-B^2=0$ 时可能有极值，也可能没有极值，需要更加高阶的讨论.

:::
## 充分条件 (一般情形)

关于上述 "Magic formal"$AC-B^2$ 是非常神奇的，我们有更加普适的结论解释，有下面矩阵

$$
M=\left[\begin{array}{ll}
f_{x x} & f_{x y} \\
f_{x y} & f_{y y}
\end{array}\right]
$$
这个矩阵其实就 [Hessan 矩阵](./17d55d61#%E4%BA%8C%E3%80%81%E6%B5%B7%E5%A1%9E%EF%BC%88Hessan%EF%BC%89%E7%9F%A9%E9%98%B5)

:::danger

- $M$ 是正定矩阵时，$f(a,b)$ 为极小值
- $M$ 是负定矩阵时，$f(a,b)$ 为极大值
- $M$ 是非正定非负定，$f(a,b)$ 不是极值

:::
同理的三元或者四元是同理的。至于原理或者证明将会在另一篇 [泰勒展开式与Hessian矩阵](./f8acb81e) 进行说明。

## 相关资料

- [故意让人难记的公式——多元函数极值](https://mp.weixin.qq.com/s?__biz=MzU1OTAzMjE2OA==&amp;mid=2247485977&amp;idx=1&amp;sn=c35473dcca80d0df80ed0a5951eb0a02&amp;chksm=fc1c381ecb6bb108a0e37e40d817594eebbe8f05efe9294a8a164d632d3a1e1eab3a33c4ede2&amp;token=2002571029&amp;lang=zh_CN#rd)
- [多元函数极值 二次型 Hessian矩阵 正定矩形 二阶泰勒展开_yuchiwang的博客-CSDN博客](https://blog.csdn.net/u013498583/article/details/79580733)
